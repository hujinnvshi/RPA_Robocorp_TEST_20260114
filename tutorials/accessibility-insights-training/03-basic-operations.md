# 教程 3: 基础操作练习

## 📋 本教程目标

完成本教程后，你将：
- 掌握查看 UI 元素的两种主要方法
- 学会在元素树中导航和搜索
- 能够准确记录元素的定位信息
- 完成记事本应用的完整练习

---

## 🎯 两种查看元素的方法

### 方法 1️⃣: 鼠标悬停法（Hover）

**适用场景:** 快速浏览多个元素

#### 操作步骤

```
步骤 1: 启动 Accessibility Insights
  □ 打开工具
  □ 点击 "Inspect" 按钮

步骤 2: 打开目标应用
  □ 启动 Windows 记事本
  □ 确保记事本窗口可见

步骤 3: 启用悬停模式
  □ 确保 "Inspect" 模式已激活
  □ 找到 "Hover Mode" 或 "Live Inspect" 选项
  □ 如果有，勾选启用

步骤 4: 悬停查看元素
  □ 将鼠标移动到记事本的标题栏
  □ 观察元素树自动跳转到对应节点
  □ 查看右侧属性面板的信息

步骤 5: 继续探索
  □ 将鼠标悬停在菜单栏 "文件"
  □ 悬停在文本输入区域
  □ 悬停在窗口边框
```

#### 优点
✅ 快速，不需要频繁点击
✅ 直观，鼠标指哪里看哪里
✅ 适合快速了解界面结构

#### 缺点
❌ 可能悬停到不想要的元素
❌ 某些元素可能无法通过悬停选中

---

### 方法 2️⃣: 点击选择法（Click）

**适用场景:** 精确定位特定元素 ⭐ RPA 最常用

#### 操作步骤

```
步骤 1: 启动 Target 模式
  □ 点击底部的 Target 按钮（靶心图标）
  □ 或按快捷键 Ctrl + Shift + T

步骤 2: 观察鼠标变化
  □ 鼠标指针变成十字准星形状
  □ Accessibility Insights 窗口可能变暗或消失

步骤 3: 选择元素
  □ 将十字准星移动到记事本的输入框
  □ 点击鼠标左键
  □ 工具窗口重新出现，并选中对应元素

步骤 4: 查看属性
  □ 查看右侧属性面板
  □ 记录关键属性（Name, AutomationId 等）

步骤 5: 取消模式
  □ 按 ESC 键退出 Target 模式
  □ 或再次点击 Target 按钮
```

#### 优点
✅ 精确，不会选错元素
✅ 可以选择任意元素，包括悬停难以选中的
✅ RPA 开发推荐方法

#### 缺点
❌ 每次都需要点击 Target 按钮
❌ 只能逐个选择，速度较慢

---

## 🌲 元素树导航技巧

### 技巧 1: 展开和折叠

```
操作:
  - 单击 ▶ 图标: 展开子节点
  - 单击 ▼ 图标: 折叠子节点
  - 双击元素名: 展开/折叠切换

快捷键:
  - → (右箭头): 展开当前节点
  - ← (左箭头): 折叠当前节点
  - ↑ (上箭头): 移动到父节点
  - ↓ (下箭头): 移动到子节点
```

---

### 技巧 2: 搜索功能

当你知道元素名称但不知道位置时：

```
步骤 1: 启动搜索
  □ 按 Ctrl + F
  □ 或在元素树顶部找到搜索框

步骤 2: 输入搜索内容
  搜索示例:
    - "Button" → 查找所有按钮
    - "Edit" → 查找所有输入框
    - "文件" → 查找包含"文件"的元素
    - "send" → 查找包含"send"的元素

步骤 3: 导航搜索结果
  □ 按 F3 或 Enter 查找下一个
  □ 按 Shift + F3 查找上一个

步骤 4: 查看匹配数量
  □ 搜索框会显示匹配结果数量
  □ 例如: "3 of 12" 表示当前是第 3 个，共 12 个匹配
```

---

### 技巧 3: 利用高亮功能

确认你选对了元素：

```
步骤 1: 选中元素
  □ 在元素树中点击某个节点

步骤 2: 启用高亮
  □ 点击 "Toggle Highlight" 按钮（灯泡图标）
  □ 或按 Ctrl + H

步骤 3: 观察目标应用
  □ 记事本中对应的元素会被红色框高亮
  □ 确认这是你想要的元素

步骤 4: 切换其他元素
  □ 选择其他元素，观察高亮位置变化
  □ 帮助理解元素树的对应关系
```

---

## 📝 记录元素信息

### 标准记录格式

为 RPA 开发记录元素信息时，建议使用以下格式：

```markdown
## 元素名称: 发送按钮

**用途:** 点击发送消息

**定位方式:**
- Name: "发送"
- AutomationId: "send_btn"
- ClassName: "Button"
- ControlType: "Button"

**推荐定位策略:**
```python
# 最优先: AutomationId
library.click('automationid:"send_btn"')

# 备选: Name + ControlType
library.click('name:"发送" AND controltype:"Button"')
```

**父元素路径:**
Window(钉钉) → Pane(主面板) → Group(聊天工具栏) → Button(发送)

**备注:**
- 元素始终可见
- 未发现同名元素
```

---

### 快速记录表格

也可以使用表格形式快速记录：

| 控件用途 | Name | AutomationId | ClassName | ControlType | 推荐定位 |
|---------|------|-------------|-----------|-------------|---------|
| 搜索框 | "搜索" | search_input | Edit | Edit | automationid |
| 发送按钮 | "发送" | send_btn | Button | Button | automationid |
| 关闭按钮 | "关闭" | (空) | Button | Button | name:"关闭" |

---

## 💻 实战练习: Windows 记事本

### 练习目标

完整分析 Windows 记事本应用的 UI 元素结构，记录所有可操作控件。

---

### 练习步骤

#### 第一部分: 启动和准备

```
□ 步骤 1: 启动 Accessibility Insights
  - 打开工具
  - 点击 "Inspect" 进入检查模式

□ 步骤 2: 启动记事本
  - 按 Win + R
  - 输入 notepad
  - 按回车

□ 步骤 3: 切换到 Accessibility Insights
  - 按 Alt + Tab 切换窗口
  - 确保能看到两个窗口
```

---

#### 第二部分: 查找窗口元素

```
□ 步骤 1: 选择记事本窗口
  - 使用 Target 模式
  - 点击记事本窗口的标题栏
  - 观察元素树选中 "Window" 类型元素

□ 步骤 2: 记录窗口信息
  - Name: _________________
  - ClassName: _________________
  - ControlType: _________________

□ 步骤 3: 展开窗口节点
  - 双击 Window 元素
  - 查看子元素列表
```

---

#### 第三部分: 分析菜单栏

```
□ 步骤 1: 查找菜单栏
  - 在元素树中展开查找 "MenuBar"
  - 或使用搜索功能搜索 "MenuBar"

□ 步骤 2: 展开菜单栏
  - 查看子菜单项: "文件"、"编辑"、"格式"等

□ 步骤 3: 选择"文件"菜单
  - 使用 Target 模式点击"文件"
  - 或在元素树中找到对应的 MenuItem

□ 步骤 4: 记录"文件"菜单信息
  - Name: _________________
  - AutomationId: _________________
  - ControlType: _________________

□ 步骤 5: 重复操作其他菜单
  - 记录"编辑"菜单属性
  - 记录"格式"菜单属性
```

---

#### 第四部分: 定位文本输入区域

这是记事本最重要的部分，RPA 需要在这里输入文字。

```
□ 步骤 1: 使用 Target 模式
  - 点击 Target 按钮
  - 将十字准星移动到记事本的白色文本区域
  - 点击选中

□ 步骤 2: 查看元素类型
  - 观察元素树选中的是 "Edit" 类型
  - 这就是文本输入框

□ 步骤 3: 记录输入框信息
  - Name: _________________
  - AutomationId: _________________
  - ClassName: _________________
  - ControlType: _________________
  - IsEnabled: _________________
  - IsOffscreen: _________________

□ 步骤 4: 测试输入
  - 切换到记事本
  - 输入一些文字
  - 切换回 Accessibility Insights
  - 按 F5 刷新，查看元素属性是否变化
```

---

#### 第五部分: 查找其他控件

```
□ 步骤 1: 滚动条
  - 在记事本中输入多行文字，出现滚动条
  - 使用 Target 模式点击滚动条
  - 记录信息

□ 步骤 2: 状态栏
  - 查看记事本底部状态栏（如果有）
  - 记录信息

□ 步骤 3: 窗口控制按钮
  - 最小化按钮
  - 最大化/还原按钮
  - 关闭按钮
  - 分别记录它们的属性
```

---

### 练习结果检查清单

完成练习后，你应该能回答：

```
□ 记事本窗口的 ControlType 是什么？
□ 文本输入框的 AutomationId 是什么？
□ "文件"菜单的 Name 属性是什么？
□ 菜单栏的父元素是什么？
□ 哪些元素有 AutomationId？哪些没有？
```

---

## 🔍 进阶练习: 查找特定元素

### 练习 1: 查找所有按钮

```
任务:
  □ 使用搜索功能搜索 "Button"
  □ 记录找到多少个按钮
  □ 列出所有按钮的 Name 属性

我的答案:
  找到 _____ 个按钮
  1. _________________
  2. _________________
  3. _________________
  ...
```

---

### 练习 2: 对比相同类型的元素

```
任务: 对比两个菜单项

"文件"菜单:
  - Name: _________________
  - AutomationId: _________________
  - ClassName: _________________

"编辑"菜单:
  - Name: _________________
  - AutomationId: _________________
  - ClassName: _________________

思考:
  - 哪些属性相同？为什么？
  - 哪些属性不同？为什么？
  - 如何在代码中区分它们？
```

---

### 练习 3: 元素路径追踪

```
任务: 从根节点到目标元素的完整路径

示例: 记事本输入框的路径

路径:
  Window (记事本)
    └─ TitleBar (标题栏)
    └─ MenuBar (菜单栏)
    └─ Edit (文本输入框) ← 目标元素

RPA 代码表示:
  library.windows_window("记事本") \
    .find_element("controltype:Edit")
```

---

## 🎯 实战应用: 编写 RPA 代码

基于你在练习中收集的信息，尝试编写代码：

```python
from RPA.Windows import Windows

library = Windows()

# 1. 启动记事本
library.open_app('notepad.exe')

# 2. 选择记事本窗口
# 使用你在练习中记录的 Name 属性
notepad = library.windows_window('无标题 - 记事本')

# 3. 点击文本输入框
# 使用你在练习中记录的 ControlType
input_box = notepad.find_element('controltype:Edit')
input_box.click()

# 4. 输入文字
library.write_text('Hello from RPA!')

# 5. 查找并点击"文件"菜单
# 使用你在练习中记录的信息
file_menu = notepad.find_element('name:"文件"')
file_menu.click()

# 6. 查找并点击"保存"
# 提示: 点击"文件"后会出现下拉菜单
# 需要等待菜单出现再操作
```

---

## 📊 练习总结表

完成所有练习后，填写此总结表：

| 元素类型 | 找到数量 | 有 AutomationId | 推荐定位方式 |
|---------|---------|----------------|-------------|
| 按钮 | ___ 个 | 是 / 否 | _________________ |
| 输入框 | ___ 个 | 是 / 否 | _________________ |
| 菜单项 | ___ 个 | 是 / 否 | _________________ |
| 窗口 | ___ 个 | 是 / 否 | _________________ |

---

## 🎓 知识检测

1. **Target 模式的快捷键是？**
   <details>
   <summary>点击查看答案</summary>
   Ctrl + Shift + T
   </details>

2. **如何刷新元素树？**
   <details>
   <summary>点击查看答案</summary>
   按 F5 或点击 Refresh 按钮
   </details>

3. **Name 和 AutomationId 哪个更稳定？**
   <details>
   <summary>点击查看答案</summary>
   AutomationId 更稳定，因为它不容易变化
   </details>

4. **如何确认选中了正确的元素？**
   <details>
   <summary>点击查看答案</summary>
   使用 Toggle Highlight 功能（Ctrl + H），目标元素会被红色框高亮
   </details>

---

## 📝 学习笔记

```
在本教程中，我学到了:

1. 两种查看元素的方法:
   - 鼠标悬停法: 快速浏览
   - 点击选择法: 精确定位 (RPA 推荐)

2. 元素树导航技巧:
   - 展开/折叠: 双击或点击箭头
   - 搜索: Ctrl + F
   - 高亮: Ctrl + H

3. 记录元素信息的格式:
   - 元素用途
   - 定位属性 (Name, AutomationId 等)
   - 推荐定位策略
   - 父元素路径

4. 实战经验:
   - 记事本的输入框类型是 Edit
   - 不是所有元素都有 AutomationId
   - 元素树是层级结构，需要理解父子关系
```

---

## 🚀 下一步

恭喜你完成了基础操作练习！现在让我们进入[教程 4: 钉钉实战练习](./04-dingtalk-practice.md)，针对实际应用进行元素定位！

---

**💡 小贴士:** 建议保存你的练习记录，后续编写 RPA 代码时会用到！
